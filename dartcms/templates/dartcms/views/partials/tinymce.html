{% load i18n dartcms_helpers %}

<script type="text/javascript">
    function mceInit() {
        var options = {
            {% get_current_language as LANG %}
            {% if LANG == 'ru-ru' %}
                language: 'ru',
            {% endif %}
            selector: ".rte",
            content_css: 'https://netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css',
            noneditable_noneditable_class: 'fa',
            plugins: 'fontawesome noneditable advlist autolink link image lists charmap print preview code table textcolor',
            toolbar: 'undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | table | fontsizeselect | forecolor backcolor | fontawesome',
            file_browser_callback: filebrowserCallback,
            relative_urls: false,
            remove_script_host: false,
            extended_valid_elements: 'span[*]'
        };

        {% get_tinymce_settings as tinymce_settings %}

        {% if tinymce_settings %}
            {% for option, value in tinymce_settings.items %}
                if (options.hasOwnProperty('{{ option }}')) {
                    options['{{ option }}'] += ',{{ value }}';
                } else {
                    options['{{ option }}'] = '{{ value }}';
                }
            {% endfor %}
        {% endif %}

        tinymce.init(options);
    }
    function filebrowserCallback(field_name, url, type, win) {
        tinymce.activeEditor.windowManager.open({
            file: '{% url 'dartcms:filemanager:index' %}',
            title: 'Filemanager',
            width: 900,
            height: 450,
            resizable: 'yes'
        }, {
            setUrl: function (url) {
                url = url.replace('//', '/');
                win.document.getElementById(field_name).value = url;
            }
        });
        return false;
    }
    function mceDestroy() {
        tinymce.remove();
    }
</script>